<nav class="navbar navbar-expand-lg bg-white border-bottom fixed-top">
  <div class="container">
    <a class="navbar-brand fw-semibold d-flex align-items-center gap-2" href="/">
      <i class="bi bi-gem"></i>
      SnapBid
    </a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="mainNav">
      <ul class="navbar-nav ms-auto align-items-lg-center gap-lg-3">
        <% if user_signed_in? %>
          <li class="nav-item"><%= link_to "Trang chủ", root_path, class: "nav-link" %></li>
          <li class="nav-item"><%= link_to "Đăng bán", seller_listings_path, class: "nav-link" %></li>
          <li class="nav-item"><%= link_to "Đấu giá của tôi", my_bids_path, class: "nav-link" %></li>
          <li class="nav-item position-relative">
            <!-- chuông notifications: dùng partial cũ của bạn -->
            <%= render "shared/notifications_bell" %>
          </li>

          <li class="nav-item position-relative"
              data-controller="dropdown">
            <a class="nav-link dropdown-toggle d-flex align-items-center gap-2"
              href="#"
              role="button"
              data-action="click->dropdown#toggle">
              <span class="rounded-circle bg-secondary-subtle d-inline-flex align-items-center justify-content-center overflow-hidden border"
                    style="width:32px;height:32px;">
                <% if current_user.avatar.attached? %>
                  <%= image_tag current_user.avatar.variant(resize_to_fill: [32, 32]),
                        class: "w-100 h-100",
                        style: "object-fit:cover;" %>
                <% else %>
                  <i class="bi bi-person"></i>
                <% end %>
              </span>
              <span class="d-none d-lg-inline"><%= current_user.name.presence || current_user.email %></span>
            </a>

            <ul class="dropdown-menu dropdown-menu-end"
                data-dropdown-target="menu"
                style="margin-top: 8px;">
              <li><%= link_to "Đơn hàng", orders_path, class: "dropdown-item" %></li>

              <li><%= link_to "Tài khoản", profile_path, class: "dropdown-item" %></li>

              <% if current_user.admin? %>
                <li><%= link_to "Admin", admin_orders_path, class: "dropdown-item" %></li>
              <% end %>

              <li><hr class="dropdown-divider"></li>

              <li>
                <%= button_to "Logout",
                      destroy_user_session_path,
                      method: :delete,
                      form: { class: "m-0" },
                      class: "dropdown-item text-danger",
                      data: { turbo_confirm: "Bạn chắc chắn muốn đăng xuất?" } %>
              </li>
            </ul>
          </li>

        <% else %>
          <li class="nav-item"><%= link_to "Home", root_path, class: "nav-link" %></li>
          <li class="nav-item"><%= link_to "About", "#", class: "nav-link" %></li>
          <li class="nav-item"><%= link_to "Contact", "#", class: "nav-link" %></li>
          <li class="nav-item">
            <%= link_to "Đăng nhập", new_user_session_path, class: "btn btn-outline-primary btn-sm" %>
          </li>
          <li class="nav-item">
            <%= link_to "Đăng ký", new_user_registration_path, class: "btn btn-primary btn-sm" %>
          </li>
        <% end %>
      </ul>
    </div>
  </div>
</nav>
